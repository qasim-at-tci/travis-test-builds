language: objective-c
os:
  - osx
osx_image:
  - xcode11.6
before_install:
  - brew tap adoptopenjdk/openjdk
  - brew install --cask adoptopenjdk8
  - brew install --cask android-sdk
  - brew install jq ninja
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -rf $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
    - "$HOME/.android/build-cache"
env:
  global:
    - HOMEBREW_NO_INSTALL_CLEANUP: "1"
    - ANDROID_HOME: "/usr/local/share/android-sdk"
    - ANDROID_NDK_HOME: "/usr/local/share/android-ndk"
    - JAVA_HOME: "/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home"
    - TERM: dumb
before_script:
  - yes | $ANDROID_HOME/tools/bin/sdkmanager "platforms;android-28" > /dev/null
  - yes | $ANDROID_HOME/tools/bin/sdkmanager --licenses > /dev/null
  - curl --silent -o ndk.zip https://dl.google.com/android/repository/android-ndk-r16b-darwin-x86_64.zip
  - unzip -qq ndk.zip > /dev/null
  - rm ndk.zip
  - mv android-ndk-r16b $ANDROID_NDK_HOME

script: true
